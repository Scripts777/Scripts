local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Функция для клонирования предмета с попыткой сохранить анимации
local function cloneItemToBackpack()
    -- Проверяем, есть ли персонаж и предмет в руке
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Tool") then
        local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
        
        -- Клонируем предмет
        local clonedTool = tool:Clone()
        
        -- Устанавливаем родителя в Backpack
        clonedTool.Parent = LocalPlayer.Backpack
        
        -- Проверяем наличие локальных скриптов в предмете
        for _, obj in pairs(clonedTool:GetDescendants()) do
            if obj:IsA("LocalScript") then
                -- Пытаемся активировать локальный скрипт
                local scriptClone = obj:Clone()
                scriptClone.Parent = clonedTool
                scriptClone.Disabled = false
            end
        end
        
        -- Проверяем наличие Animation объектов
        for _, obj in pairs(clonedTool:GetDescendants()) do
            if obj:IsA("Animation") then
                -- Пытаемся загрузить анимацию через Humanoid
                local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    local animator = humanoid:FindFirstChildOfClass("Animator") or Instance.new("Animator", humanoid)
                    local animationTrack = animator:LoadAnimation(obj)
                    animationTrack:Play() -- Пробуем воспроизвести анимацию
                end
            end
        end
        
        -- Уведомление в консоли
        print("Клонирован предмет: " .. clonedTool.Name .. " в Backpack (локально)")
    else
        warn("Нет предмета в руке!")
    end
end

-- Создаем локальный GUI для активации скрипта
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 200, 0, 50)
Frame.Position = UDim2.new(0.5, -100, 0.5, -25)
Frame.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
Frame.Parent = ScreenGui

local Button = Instance.new("TextButton")
Button.Size = UDim2.new(0, 180, 0, 30)
Button.Position = UDim2.new(0.5, -90, 0.5, -15)
Button.Text = "Клонировать предмет"
Button.TextColor3 = Color3.new(1, 1, 1)
Button.BackgroundColor3 = Color3.new(0, 0.5, 0)
Button.Parent = Frame

-- Привязываем функцию к кнопке
Button.MouseButton1Click:Connect(cloneItemToBackpack)
